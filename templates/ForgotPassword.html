<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous"/>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/static/Food_Munch_Css_Styles/LoginPage.css">
    </head>
    <body>
        <div class="col-12 outer-form-container d-flex flex-column justify-content-center">
            <div class="mt-3 mb-3">
                <div class="form-list shadow-lg">
                    <h1 class="main-container" id="FormHeading">Password Verification</h1>
                    <form method="POST" action="{% url 'forgot password' %}">
                        {% csrf_token %}
                        <div class="form-container" id="form-container">
                            <div id="ForgotMobileNumber">
                                <label for="mobilenumber" class="form-heading mb-3" id="OTPHeading">Mobile Number <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTXBlHGWGV0gXcdXkBHHLqUHVlSchZwZLylgyZrXLRjp8X2Ob4FGLHBwxKUQKFra1Vqx8k&usqp=CAU" alt="star-image" class="star-image"/></label>
                                <input type="text" class="form-control mb-3" id="InputMobileNumber" name="LoginMobileNumber" placeholder="Enter mobile number to continue" required>
                            </div>
                            <div class="button-container" id="GetOTP">
                                <button type="button" class="login-button btn btn-info" onclick="GetOTP()">Get OTP</button>
                            </div>
                        </div>
                        <script type="text/javascript">
                            function GetOTP() {
                                document.getElementById("FormHeading").style.display = "none";
                                document.getElementById("ForgotMobileNumber").style.display = "none";
                                document.getElementById("GetOTP").style.display = "none";
                                let FormContainer = document.getElementById("form-container");

                                var ImageContainer = document.createElement("div");
                                ImageContainer.setAttribute("id", "ImageContainer");
                                var ArrowImg = document.createElement("img");
                                ArrowImg.src = "https://cdn-icons-png.flaticon.com/512/66/66822.png";
                                ArrowImg.className = "ArrowImage";
                                ArrowImg.setAttribute("id","ArrowImage")
                                // Use ArrowImg instead of ArrowImage here
                                ArrowImg.addEventListener("click", function() {
                                    // Navigate back to the previous page
                                    window.location.href = "{% url 'forgot password' %}";
                                });
                                ImageContainer.appendChild(ArrowImg);
                                FormContainer.appendChild(ImageContainer);

                                var PasswordInput = document.createElement("h1");
                                PasswordInput.textContent = "Enter OTP sent to your mobile number";
                                PasswordInput.className = "main-container";
                                ImageContainer.appendChild(PasswordInput);
                                FormContainer.appendChild(ImageContainer);

                                var CountDownLimit = document.createElement("h1");
                                CountDownLimit.textContent = "2:00";
                                CountDownLimit.className = "main-container";
                                ImageContainer.appendChild(CountDownLimit);
                                FormContainer.appendChild(ImageContainer);

                                var InputBoxContainer = document.createElement("div");
                                InputBoxContainer.setAttribute("id", "InputBoxContainer");
                                InputBoxContainer.className = "InputBoxContainer";
                                let InputBox1 = document.createElement("input");
                                let InputBox2 = document.createElement("input");
                                let InputBox3 = document.createElement("input");
                                let InputBox4 = document.createElement("input");
                                InputBox1.setAttribute("type", "text");
                                InputBox2.setAttribute("type", "text");
                                InputBox3.setAttribute("type", "text");
                                InputBox4.setAttribute("type", "text");
                                InputBox1.setAttribute("name","OTPInputBox1")
                                InputBox2.setAttribute("name","OTPInputBox2")
                                InputBox3.setAttribute("name","OTPInputBox3")
                                InputBox4.setAttribute("name","OTPInputBox4")
                                InputBox1.setAttribute("maxlength", "1");
                                InputBox2.setAttribute("maxlength", "1");
                                InputBox3.setAttribute("maxlength", "1");
                                InputBox4.setAttribute("maxlength", "1");
                                InputBox1.required = true;
                                InputBox2.required = true;
                                InputBox3.required = true;
                                InputBox4.required = true;
                                InputBox1.className = "InputBoxSizing";
                                InputBox2.className = "InputBoxSizing";
                                InputBox3.className = "InputBoxSizing";
                                InputBox4.className = "InputBoxSizing";
                                InputBoxContainer.appendChild(InputBox1);
                                InputBoxContainer.appendChild(InputBox2);
                                InputBoxContainer.appendChild(InputBox3);
                                InputBoxContainer.appendChild(InputBox4);
                                FormContainer.appendChild(InputBoxContainer);

                                // Get all input boxes
                                var InputBoxes = InputBoxContainer.getElementsByTagName('input');
                                InputBoxes = Array.from(InputBoxes);
                                // Add event listeners to each input box
                                InputBoxes.forEach(function (inputBox, index) {
                                    inputBox.addEventListener('input', function () {
                                        // If current input box is not the last one
                                        if (index < InputBoxes.length - 1) {
                                            // If the input box is filled
                                            if (inputBox.value.length === inputBox.maxLength) {
                                                // Move focus to the next input box
                                                InputBoxes[index + 1].focus();
                                            }
                                        }
                                    });

                                    inputBox.addEventListener('keyup', function (event) {
                                        if (event.key === 'Backspace' && inputBox.value.length === 0) {
                                            // If the input box is empty after releasing the backspace key
                                            // and it's not the first input box
                                            if (index > 0) {
                                                // Move focus to the previous input box
                                                InputBoxes[index - 1].focus();
                                            }
                                        }
                                    });
                                });
                                BreakElement=document.createElement("br");
                                InputBoxContainer.appendChild(BreakElement);
                                const VerifyOTP=document.createElement("button");
                                VerifyOTP.textContent="Verify OTP";
                                VerifyOTP.setAttribute("type","submit");
                                VerifyOTP.classList.add("btn","btn-success","mt-3");
                                InputBoxContainer.appendChild(VerifyOTP);
                                //Creating Line Break Element and appending it
                                FormContainer.appendChild(InputBoxContainer);
                            }
                        </script>
                    </form>
                </div>
            </div>
        </div>
    </body>
</html>
