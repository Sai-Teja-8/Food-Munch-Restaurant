<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/20c5629a29.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/static/Food_Munch_Css_Styles/Payment_Section.css">
    </head>
    {% load static %}
    <body class="outer-container">
        <div>
            {% if ErrorFlag == True %}
                {% for Error in ErrorMsgList %}
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <strong>{{Error}}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
        <div class="container">
            <form method="POST" action="{% url 'successpage' %}">
                <div class="mt-2 mb-4">
                    <img src="{% static 'Payment_Section_Images/LeftArrow.jpg' %}" onclick='ImageRedirect()' alt="Left Arrow Image" style="height:20px;width:25px;">
                </div>
                <script type="text/javascript">
                    function ImageRedirect() {
                        window.location.assign("{% url 'exploremenu' %}")
                    }
                </script>
                {% csrf_token %}
                <div class="row">
                    <div class="col">
                        <h3 class="title">
                            Billing Address
                        </h3>
                        <div class="inputBox">
                            <label for="name" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Name of the Customer <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                            <input type="text" id="name" name="CustomerFullName" placeholder="Enter your full name" maxlength="100" autocomplete="off" required>
                        </div>
                        <div class="inputBox">
                            <label for="email" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Email Id <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                            <input type="text" id="email" name="CustomerEmailId" placeholder="Enter Email ID" autocomplete="off" required>
                        </div>
                        <div class="inputBox">
                            <label for="mobilenumber" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Mobile Number <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                            <input type="text" id="mobilenumber" name="CustomerMobileNumber" placeholder="Enter Mobile Number" maxlength="10" autocomplete="off" required>
                        </div>
                        <div class="inputBox">
                            <label for="address" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Enter Delivery Address <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                            <input type="text" id="address"  name="CustomerAddress"  placeholder="Enter address" maxlength="250" autocomplete="off" required>
                        </div>
                        <div class="inputBox">
                            <label for="city" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">City <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                            <input type="text" id="city" name="CustomerCity" placeholder="Enter city" maxlength="50" autocomplete="off" required>
                        </div>
                        <div class="flex">
                            <div class="inputBox">
                                <label for="State" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">State <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                                <select name="CustomerState" id="State" required>
                                    <option value="">Choose State</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                    <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                    <option value="Assam">Assam</option>
                                    <option value="Bihar">Bihar</option>
                                    <option value="Chhattisgarh">Chhattisgarh</option>
                                    <option value="Goa">Goa</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Himachal Pradesh">Himachal Pradesh</option>
                                    <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                    <option value="Jharkhand">Jharkhand</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="Kerala">Kerala</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Manipur">Manipur</option>
                                    <option value="Meghalaya">Meghalaya</option>
                                    <option value="Mizoram">Mizoram</option>
                                    <option value="Nagaland">Nagaland</option>
                                    <option value="Odisha">Odisha</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajashthan</option>
                                    <option value="Sikkim">Sikkim</option>
                                    <option value="Tamil Nadu">Tamil Nadu</option>
                                    <option value="Telangana">Telangana</option>
                                    <option value="Tripura">Tripura</option>
                                    <option value="Uttarakhand">Uttarakhand</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="West Bengal">West Bengal</option>
                                </select>
                            </div>
                            <div class="inputBox">
                                <label for="zip" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Zip Code <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                                <input type="text" id="zip" name="CustomerPinCode" placeholder="123456" maxlength="6" autocomplete="off" required>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <h3 class="title">Payment</h3>
                        <div>
                            <h1 style="font-family:'Poppins';font-size:24px;color:green;">Ordered Food Item</h1>
                            <div class="d-flex flex-row">
                                <div>
                                    <img src="{% static SectionName %}/{{ Image }}.jpg" alt="{{ ItemName }}" style="height:80px;width:80px;border-radius:10px;">
                                </div>
                                <div class="ml-3">
                                    <h1 style="font-family:'Poppins';font-size:20px; font-weight:bold;color:navy;">{{ItemName}}</h1>
                                    <p style="font-family:'Poppins';font-size:18px;color:green;font-weight:bold;">Order Total : {{Cost}}</p>
                                </div>
                            </div>
                        </div>
                        <div class="inputBox">
                            <label for="name" style="font-family:'Poppins';font-size:17px;color:#3C4142;font-weight:500;">Cards Accepted <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                            <img src="{% static 'Payment_Section_Images/cardlogos.jpg' %}" alt="credit/debit card image">
                        </div>
                        <div class="flex">
                            <div class="inputBox">
                                <label for="PaymentSectionMethod" style="font-family:'Poppins';font-size:17px;color:#3C4142;font-weight:bold;">Select Payment Method <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/></label>
                                <select name="CustomerPaymentMethod" id="PaymentSectionMethod" onchange="toggleFields()" required>
                                    <option value="">Choose Payment Method</option>
                                    <option value="card">Card Payment</option>
                                    <option value="phonepe">PhonePe</option>
                                    <option value="paypal">PayPal</option>
                                </select>
                                <div id="cardFields" class="hidden mt-3 mb-3">
                                    <label for="CardName" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Card Name <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/> </label>
                                    <input type="text" name="CustomerCardName" id="cardName"  placeholder="Enter Card Name" maxlength="50" autocomplete="off" required>
                                    <br>
                                    <label for="CardNumber" class="mt-3" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Card Number <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/> </label>
                                    <input type="text" name="CustomerCardNumber" id="cardNumber"  placeholder="Enter 16 digits Card Number" maxlength="19" autocomplete="off" required>
                                    <div class="d-flex flex-row">
                                        <div>
                                            <label for="Expiry" class="mt-3" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Exipry Date <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/> </label>
                                            <input type="text" name="CustomerCardExpiry" id="Expiry"  placeholder="mm/yyyy" autocomplete="off" required>
                                        </div>
                                        <script>
                                            document.getElementById("Expiry").addEventListener("input", function(e) {
                                                var input = e.target.value.replace(/\D/g, '').substring(0, 6);
                                                var month = input.substring(0, 2);
                                                var year = input.substring(2, 6);
                                                if (input.length > 2) {
                                                    input = month + '/' + year;
                                                }
                                                e.target.value = input;
                                            });
                                        </script>
                                        <div class="ml-4">
                                            <label for="CVV" class="mt-3" style="font-family:'Poppins';font-size:17px;color:black;font-weight:500;">Cvv <img src="{% static 'Star_Pattern/starpattern.png' %}" alt="star-image" style="height:10px;border:none;margin-top:-10px;"/> </label>
                                            <input type="text" name="CustomerCvv" id="CVV" placeholder="Enter Cvv Code" maxlength="3" autocomplete="off" required>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    let cardNumInput = document.querySelector('#cardNumber') 
                                    cardNumInput.addEventListener('keyup', () => { 
                                        let cNumber = cardNumInput.value 
                                        cNumber = cNumber.replace(/\s/g, "") 
                                        if (Number(cNumber)) { 
                                            cNumber = cNumber.match(/.{1,4}/g) 
                                            cNumber = cNumber.join(" ") 
                                            cardNumInput.value = cNumber 
                                        } 
                                    })
                                </script>
        
                                <div id="phonepeFields" class="hidden">
                                    <h1 style="font-family:'Poppins';font-size:17px;color:#3C4142;font-weight:500;margin-top:20px;">Scan The generated QR code to make payment</h1>
                                    <img src="{% static 'Payment_Section_Images/Barcode.jpg' %}" style="height:300px;margin-top:40px;" alt="Barcode" class="Barcode-Image"/>
                                </div>
                                
                                <div id="paypalFields" class="hidden">
                                    <div class="d-flex flex-row">
                                        <img src="{% static 'Payment_Section_Images/alert.jpg' %}" alt="alert" style="height:20px;margin-top:20px;"/>
                                        <h1 style="font-family:'Poppins';font-size:14px;color:#8B0000;font-weight:200;margin-left:5px;margin-top:20px;font-weight:bold;">PayPal Bank is not available due to technical issue. Choose a different payment option to complete your payment.</h1>
                                    </div>
                                </div>
                                <script>
                                    function toggleFields() {
                                        var paymentMethod = document.getElementById("PaymentSectionMethod").value;
                                        var cardFields = document.getElementById("cardFields");
                                        var phonepeFields = document.getElementById("phonepeFields");
                                        var paypalFields = document.getElementById("paypalFields");
                                
                                        cardFields.classList.add("hidden");
                                        phonepeFields.classList.add("hidden");
                                        paypalFields.classList.add("hidden");
                                
                                        if (paymentMethod === "card") {
                                            cardFields.classList.remove("hidden");
                                        } else if (paymentMethod === "phonepe") {
                                            phonepeFields.classList.remove("hidden");
                                        } else if (paymentMethod === "paypal") {
                                            paypalFields.classList.remove("hidden");
                                        }
                                    }
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <button type="submit" class="btn btn-outline-success submit_btn">Proced To Pay</button>
                </div>
            </form>
        </div>
    </body>
</html>